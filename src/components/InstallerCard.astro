---
const { installer } = Astro.props;
const rating = typeof installer.rating === "number" ? installer.rating : undefined;
const fullStars = rating ? Math.round(rating) : 0;
const services = installer.services ?? [];
---
<article class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-md">
  <header class="flex items-center justify-between gap-4">
    <h3 class="text-lg font-semibold text-slate-900">{installer.name}</h3>
    {installer.verified && (
      <span class="inline-flex items-center gap-1 rounded-full bg-accent-100 px-3 py-1 text-xs font-semibold text-accent-700">
        <span aria-hidden="true">✔</span>
        Verified
      </span>
    )}
  </header>
  {rating && (
    <p class="mt-2 flex items-center gap-2 text-sm text-slate-600">
      <span class="flex gap-0.5 text-accent-600" aria-hidden="true">
        {Array.from({ length: 5 }).map((_, index) => (
          <span class={index < fullStars ? "text-accent-600" : "text-slate-300"}>&#9733;</span>
        ))}
      </span>
      <span class="font-medium">{rating.toFixed(1)}</span>
    </p>
  )}
  <p class="mt-3 text-sm text-slate-600">
    {services.length > 0 ? services.join(" • ") : "Rainwater harvesting services"}
  </p>
  <dl class="mt-4 flex flex-wrap gap-4 text-sm text-slate-600">
    {installer.phone && (
      <div>
        <dt class="font-semibold text-slate-700">Phone</dt>
        <dd><a class="hover:text-primary-600" href={`tel:${installer.phone}`}>{installer.phone}</a></dd>
      </div>
    )}
    {installer.website && (
      <div>
        <dt class="font-semibold text-slate-700">Website</dt>
        <dd>
          <a class="hover:text-primary-600" href={installer.website} rel="noopener" target="_blank">
            Visit site
          </a>
        </dd>
      </div>
    )}
  </dl>
</article>
